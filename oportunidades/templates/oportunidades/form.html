{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-md-10">
            <div class="card shadow-sm">
                <div class="card-body">
                    <h2 class="card-title mb-4">
                        {% if form.instance.pk %}Editar{% else %}Crear{% endif %} Oportunidad
                    </h2>
                    
                    {% if form.non_field_errors %}
                        <div class="alert alert-danger">
                            {% for error in form.non_field_errors %}
                                {{ error }}
                            {% endfor %}
                        </div>
                    {% endif %}

                    <form method="post" class="needs-validation" novalidate>
                        {% csrf_token %}
                        
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <!-- Título -->
                                <div class="mb-3">
                                    <label for="{{ form.titulo.id_for_label }}" class="form-label">Título *</label>
                                    {{ form.titulo }}
                                    {% if form.titulo.errors %}
                                        <div class="invalid-feedback d-block">
                                            {{ form.titulo.errors.0 }}
                                        </div>
                                    {% endif %}
                                </div>
                                
                                <!-- Organización -->
                                <div class="mb-3">
                                    <label for="{{ form.organizacion.id_for_label }}" class="form-label">Organización *</label>
                                    {{ form.organizacion }}
                                    {% if form.organizacion.errors %}
                                        <div class="invalid-feedback d-block">
                                            {{ form.organizacion.errors.0 }}
                                        </div>
                                    {% endif %}
                                </div>
                                
                                <!-- Ubicación -->
                                <div class="mb-3">
                                    <label for="{{ form.ubicacion.id_for_label }}" class="form-label">Ubicación *</label>
                                    {{ form.ubicacion }}
                                    {% if form.ubicacion.errors %}
                                        <div class="invalid-feedback d-block">
                                            {{ form.ubicacion.errors.0 }}
                                        </div>
                                    {% endif %}
                                </div>
                                
                                <!-- Fechas -->
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="{{ form.fecha_inicio.id_for_label }}" class="form-label">Fecha de inicio *</label>
                                        {{ form.fecha_inicio }}
                                        {% if form.fecha_inicio.errors %}
                                            <div class="invalid-feedback d-block">
                                                {{ form.fecha_inicio.errors.0 }}
                                            </div>
                                        {% endif %}
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="{{ form.fecha_fin.id_for_label }}" class="form-label">Fecha de finalización *</label>
                                        {{ form.fecha_fin }}
                                        {% if form.fecha_fin.errors %}
                                            <div class="invalid-feedback d-block">
                                                {{ form.fecha_fin.errors.0 }}
                                            </div>
                                        {% endif %}
                                    </div>
                                </div>
                                
                                <!-- Horario -->
                                <div class="mb-3">
                                    <label for="{{ form.horario.id_for_label }}" class="form-label">Horario *</label>
                                    {{ form.horario }}
                                    <div class="form-text">{{ form.horario.help_text }}</div>
                                    {% if form.horario.errors %}
                                        <div class="invalid-feedback d-block">
                                            {{ form.horario.errors.0 }}
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <!-- Cupos -->
                                <div class="mb-3">
                                    <label for="{{ form.cupos.id_for_label }}" class="form-label">Cupos disponibles *</label>
                                    {{ form.cupos }}
                                    {% if form.cupos.errors %}
                                        <div class="invalid-feedback d-block">
                                            {{ form.cupos.errors.0 }}
                                        </div>
                                    {% endif %}
                                </div>
                                
                                <!-- Estado -->
                                <div class="mb-3">
                                    <label for="{{ form.estado.id_for_label }}" class="form-label">Estado *</label>
                                    {{ form.estado }}
                                    {% if form.estado.errors %}
                                        <div class="invalid-feedback d-block">
                                            {{ form.estado.errors.0 }}
                                        </div>
                                    {% endif %}
                                </div>
                                
                                <!-- Requisitos -->
                                <div class="mb-3">
                                    <label for="{{ form.requisitos.id_for_label }}" class="form-label">Requisitos *</label>
                                    {{ form.requisitos }}
                                    <div class="form-text">Lista los requisitos necesarios, uno por línea.</div>
                                    {% if form.requisitos.errors %}
                                        <div class="invalid-feedback d-block">
                                            {{ form.requisitos.errors.0 }}
                                        </div>
                                    {% endif %}
                                </div>
                                
                                <!-- Beneficios -->
                                <div class="mb-3">
                                    <label for="{{ form.beneficios.id_for_label }}" class="form-label">Beneficios *</label>
                                    {{ form.beneficios }}
                                    <div class="form-text">Describe los beneficios que ofrece el voluntariado.</div>
                                    {% if form.beneficios.errors %}
                                        <div class="invalid-feedback d-block">
                                            {{ form.beneficios.errors.0 }}
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                            
                            <!-- Descripción -->
                            <div class="col-12 mb-3">
                                <label for="{{ form.descripcion.id_for_label }}" class="form-label">Descripción *</label>
                                {{ form.descripcion }}
                                {% if form.descripcion.errors %}
                                    <div class="invalid-feedback d-block">
                                        {{ form.descripcion.errors.0 }}
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                        
                        <div class="d-flex justify-content-between mt-4">
                            <a href="{% if form.instance.pk %}{% url 'detalle_oportunidad' form.instance.pk %}{% else %}{% url 'lista_oportunidades' %}{% endif %}" 
                               class="btn btn-secondary">
                                <i class="fas fa-times me-1"></i> Cancelar
                            </a>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save me-1"></i> Guardar
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    /* Estilos generales para los campos */
    .form-control, .form-select {
        margin-bottom: 0.25rem;
    }
    
    /* Estilo para los campos de texto largo */
    textarea.form-control {
        min-height: 120px;
    }
    
    /* Mejora el espaciado de los labels */
    .form-label {
        font-weight: 500;
        margin-bottom: 0.3rem;
    }
    
    /* Estilo para los textos de ayuda */
    .form-text {
        font-size: 0.8rem;
        color: #6c757d;
        margin-top: 0.25rem;
    }
    
    /* Estilo para los campos requeridos */
    .required-field::after {
        content: " *";
        color: #dc3545;
    }
</style>

<!-- Script para validación del lado del cliente -->
<script>
// Ejemplo de validación de formulario del lado del cliente
(function() {
    'use strict';
    window.addEventListener('load', function() {
        var forms = document.getElementsByClassName('needs-validation');
        var validation = Array.prototype.filter.call(forms, function(form) {
            form.addEventListener('submit', function(event) {
                if (form.checkValidity() === false) {
                    event.preventDefault();
                    event.stopPropagation();
                }
                form.classList.add('was-validated');
            }, false);
        });
    }, false);
})();
</script>
{% endblock %}
